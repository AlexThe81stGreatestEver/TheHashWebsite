{% extends "fullwidth.twig" %}

{% block content %}

    <script>
      function getSearchParams(k) {
        var p={};
        location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(s,k,v){p[k]=v});
        return k?p[k]:p;
      }

      function writeCheckbox(name, label) {

        var checked = "";

        if(!(getSearchParams(name) === "false")) {
          checked=" checked='checked'";
        }

        document.write("<input onchange='reload()' name='" + name + "' type='checkbox'" + checked + "></input> " + label + " ");
      }

      function getState(qs, name) {
        if(!$("input[name=" + name + "]").prop("checked")) {
          if(qs === "") {
            qs += "?";
          } else {
            qs += "&";
          }
          qs += name + "=false";
        }
        return qs;
      }

      function reload() {
        var qs = "";
        qs = getState(qs, "active");
        qs = getState(qs, "inactive");
        qs = getState(qs, "deceased");
        location.replace(location.href.split('?')[0] + qs);
      }

  $(document).ready(function() {
    //Convert the main table into a data table
    $('#the_main_table').DataTable({
      "paging":   true,
      "pageLength": 50,
      "lengthMenu": [ [50, 100, 500, -1], [50, 100, 500, "All"]],
      "aaSorting": [],
      "responsive": true,
      "autoWidth": false,
      "processing": true
    });
  });

    </script>

    <h1>{{pageTitle}}</h1>
    <table id="the_main_table" class="table table-condensed table-hover">
      <caption>{{tableCaption}}</caption>
      <thead>
        <tr>
          <td colspan="3">Filters:
            <script>
              writeCheckbox("active", "Active");
              writeCheckbox("inactive", "Inactive");
              writeCheckbox("deceased", "Deceased");
            </script>
          </td>
        </tr>
        <tr>
          <th>Rank</th>
          <th>{{columnOneName}}</th>
          <th>{{columnTwoName}}</th>
        </tr>
      </thead>
      <tbody>
        {% for item in theList %}
          <tr>
            <td>{{item.THE_RANK}}</td>
            {% if google_analytics_id != 'none' %}
              <td><a href="/{{kennel_abbreviation}}/hashers/{{item.THE_KEY}}?name={{item.NAME}}&src={{pageTracking}}">{{item.NAME}}</a>{{item.STATUS}}</td>
            {% else %}
              <td><a href="/{{kennel_abbreviation}}/hashers/{{item.THE_KEY}}">{{item.NAME}}</a>{{item.STATUS}}</td>
            {% endif %}
            <td>{{item.VALUE}}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

{% endblock %}
