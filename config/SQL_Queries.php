<?php


define("HASHING_COUNTS","SELECT
	HASHERS.HASHER_NAME AS NAME,
	COUNT(0) AS VALUE
FROM
	HASHERS
	JOIN HASHINGS ON HASHERS.HASHER_KY = HASHINGS.HASHER_KY
	JOIN HASHES on HASHINGS.HASH_KY = HASHES.HASH_KY
WHERE HASHES.KENNEL_KY = ?
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC
");

define("HARING_COUNTS","SELECT
	HASHERS.HASHER_NAME AS NAME,
	COUNT(0) AS VALUE
FROM
	HASHERS
	JOIN HARINGS ON HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY
	JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
WHERE HASHES.KENNEL_KY = ?
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC"
);

define("NON_HYPER_HARING_COUNTS","SELECT
	HASHERS.HASHER_NAME AS NAME,
	COUNT(0) AS VALUE
FROM
	HASHERS
	JOIN HARINGS ON HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY
	JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
WHERE
	HASHES.KENNEL_KY = ? AND
    HASHES.IS_HYPER = 0
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC");

define("HARING_PERCENTAGES_HYPERS_VS_ALL","SELECT
	HASHERS.HASHER_NAME,
    HASHERS.HASHER_KY,
    ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT,
    HYPER_HARING_COUNT_TEMP_TABLE.HYPER_HARING_COUNT,
    ((HYPER_HARING_COUNT_TEMP_TABLE.HYPER_HARING_COUNT / ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT) * 100) AS HYPER_HARINGS_PERCENTAGE,
    (((ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT - HYPER_HARING_COUNT_TEMP_TABLE.HYPER_HARING_COUNT) / ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT) * 100) AS NON_HYPER_HARINGS_PERCENTAGE
FROM
	HASHERS
JOIN (SELECT
		HARINGS.HARINGS_HASHER_KY AS HARINGS_HASHER_KY,
		COUNT(HARINGS.HARINGS_HASHER_KY) AS ALL_HARING_COUNT
        FROM
            HARINGS
						JOIN HASHES on HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
						WHERE HASHES.KENNEL_KY = ?
        GROUP BY HARINGS.HARINGS_HASHER_KY) ALL_HARING_COUNT_TEMP_TABLE ON (HASHERS.HASHER_KY = ALL_HARING_COUNT_TEMP_TABLE.HARINGS_HASHER_KY)
JOIN (SELECT
		HARINGS.HARINGS_HASHER_KY AS HARINGS_HASHER_KY,
		COUNT(HARINGS.HARINGS_HASHER_KY) AS HYPER_HARING_COUNT
        FROM
            HARINGS JOIN HASHES on HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
				WHERE HASHES.IS_HYPER = 1
					AND HASHES.KENNEL_KY = ?
        GROUP BY HARINGS.HARINGS_HASHER_KY) HYPER_HARING_COUNT_TEMP_TABLE ON (HASHERS.HASHER_KY = HYPER_HARING_COUNT_TEMP_TABLE.HARINGS_HASHER_KY)
ORDER BY (((ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT - HYPER_HARING_COUNT_TEMP_TABLE.HYPER_HARING_COUNT) / ALL_HARING_COUNT_TEMP_TABLE.ALL_HARING_COUNT) * 100) DESC
");


define("HASHER_COUNTS_BY_YEAR","SELECT HASHERS.HASHER_NAME AS HASHER_NAME,count(*) AS THE_COUNT
  FROM (
    HASHERS
      JOIN HASHINGS ON(HASHERS.HASHER_KY = HASHINGS.HASHER_KY))
      JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
    YEAR(HASHES.EVENT_DATE) = ?
  GROUP BY hashers.HASHER_NAME ORDER BY THE_COUNT DESC"
);


define("TOTAL_HARE_COUNTS_BY_YEAR","SELECT HASHERS.HASHER_NAME AS HASHER_NAME,count(*) AS THE_COUNT
FROM (
	HASHERS
    JOIN HARINGS ON(HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY))
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
WHERE
	YEAR(HASHES.EVENT_DATE) = ?
GROUP BY HASHERS.HASHER_NAME ORDER BY THE_COUNT DESC");

define("HYPER_HARE_COUNTS_BY_YEAR","SELECT HASHERS.HASHER_NAME AS HASHER_NAME,count(*) AS THE_COUNT
FROM (
	HASHERS
    JOIN HARINGS ON(HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY))
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
WHERE
	YEAR(HASHES.EVENT_DATE) = ? AND
    HASHES.IS_HYPER = 1
GROUP BY HASHERS.HASHER_NAME ORDER BY THE_COUNT DESC");

define("NONHYPER_HARE_COUNTS_BY_YEAR","SELECT HASHERS.HASHER_NAME AS HASHER_NAME,count(*) AS THE_COUNT
FROM (
	HASHERS
    JOIN HARINGS ON(HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY))
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
WHERE
	YEAR(HASHES.EVENT_DATE) = ? AND
    HASHES.IS_HYPER = 0
GROUP BY HASHERS.HASHER_NAME ORDER BY THE_COUNT DESC");

define ("SELECT_HASHERS_VIRGIN_HASH","SELECT
	HASHES.HASH_KY,
    KENNEL_KY,
    KENNEL_EVENT_NUMBER,
    EVENT_DATE,
    EVENT_LOCATION,
    EVENT_CITY,
    EVENT_STATE,
    SPECIAL_EVENT_DESCRIPTION,
    VIRGIN_COUNT,
    IS_HYPER,
    DATE_FORMAT(EVENT_DATE,\"%m/%d/%Y\") AS EVENT_DATE_FORMATTED,
	FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365) YEARS_SINCE_EVENT,
    FLOOR((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12) MONTHS_SINCE_EVENT,
    CEILING((((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12)
            - FLOOR((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12))* 30) DAYS_SINCE_EVENT
FROM
	HASHES
    JOIN HASHINGS ON HASHES.HASH_KY = HASHINGS.HASH_KY
WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
ORDER BY
	HASHES.EVENT_DATE ASC
LIMIT 1");

define ("SELECT_HASHERS_MOST_RECENT_HASH","SELECT
	HASHES.HASH_KY,
    KENNEL_KY,
    KENNEL_EVENT_NUMBER,
    EVENT_DATE,
    EVENT_LOCATION,
    EVENT_CITY,
    EVENT_STATE,
    SPECIAL_EVENT_DESCRIPTION,
    VIRGIN_COUNT,
    IS_HYPER,
    DATE_FORMAT(EVENT_DATE,\"%m/%d/%Y\") AS EVENT_DATE_FORMATTED,
	FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365) YEARS_SINCE_EVENT,
    FLOOR((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12) MONTHS_SINCE_EVENT,
    CEILING((((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12)
            - FLOOR((DATEDIFF(CURDATE(),EVENT_DATE)/365 - FLOOR(DATEDIFF(CURDATE(),EVENT_DATE)/365))* 12))* 30) DAYS_SINCE_EVENT
FROM
	HASHES
    JOIN HASHINGS ON HASHES.HASH_KY = HASHINGS.HASH_KY
WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
ORDER BY
	HASHES.EVENT_DATE DESC
LIMIT 1");




define ("HASHER_HASH_COUNTS_BY_YEAR","SELECT YEAR(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY YEAR(EVENT_DATE)
ORDER BY YEAR(EVENT_DATE)");

define("HASHER_HASH_COUNTS_BY_MONTH","SELECT MONTH(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY MONTH(EVENT_DATE)
ORDER BY MONTH(EVENT_DATE)");

define("HASHER_HASH_COUNTS_BY_QUARTER","SELECT QUARTER(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY QUARTER(EVENT_DATE)
ORDER BY QUARTER(EVENT_DATE)
");

define("HASHER_HASH_COUNTS_BY_DAYNAME","SELECT DAYNAME(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY DAYNAME(EVENT_DATE)
ORDER BY DAYNAME(EVENT_DATE)
;");

define("HASHER_HASH_COUNTS_BY_STATE","SELECT HASHES.EVENT_STATE AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY HASHES.EVENT_STATE
ORDER BY THE_COUNT DESC"
);

define("HASHER_HASH_COUNTS_BY_CITY","SELECT HASHES.EVENT_CITY AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HASHINGS
    JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
  WHERE
	HASHINGS.HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY HASHES.EVENT_CITY
ORDER BY THE_COUNT DESC"
);

define("HASHER_ALL_HARING_COUNTS_BY_YEAR","SELECT YEAR(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY YEAR(EVENT_DATE)
ORDER BY YEAR(EVENT_DATE)");

define("HASHER_ALL_HARING_COUNTS_BY_MONTH","SELECT MONTH(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY MONTH(EVENT_DATE)
ORDER BY MONTH(EVENT_DATE)");

define("HASHER_ALL_HARING_COUNTS_BY_QUARTER","SELECT QUARTER(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY QUARTER(EVENT_DATE)
ORDER BY QUARTER(EVENT_DATE)");


define("HASHER_ALL_HARING_COUNTS_BY_DAYNAME","SELECT DAYNAME(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY DAYNAME(EVENT_DATE)
ORDER BY DAYNAME(EVENT_DATE)");

define("HASHER_ALL_HARING_COUNTS_BY_STATE","SELECT HASHES.EVENT_STATE AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY HASHES.EVENT_STATE
ORDER BY THE_COUNT DESC");

define("HASHER_ALL_HARING_COUNTS_BY_CITY","SELECT HASHES.EVENT_CITY AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ?
GROUP BY HASHES.EVENT_CITY
ORDER BY THE_COUNT DESC");

define("HASHER_NONHYPER_HARING_COUNTS_BY_YEAR","SELECT YEAR(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER = 0
GROUP BY YEAR(EVENT_DATE)
ORDER BY YEAR(EVENT_DATE)");

define("HASHER_NONHYPER_HARING_COUNTS_BY_MONTH","SELECT MONTH(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER = 0
GROUP BY MONTH(EVENT_DATE)
ORDER BY MONTH(EVENT_DATE)");

define("HASHER_NONHYPER_HARING_COUNTS_BY_QUARTER","SELECT QUARTER(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER = 0
GROUP BY QUARTER(EVENT_DATE)
ORDER BY QUARTER(EVENT_DATE)");


define("HASHER_NONHYPER_HARING_COUNTS_BY_DAYNAME","SELECT DAYNAME(EVENT_DATE) AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER = 0
GROUP BY DAYNAME(EVENT_DATE)
ORDER BY DAYNAME(EVENT_DATE)");

define("HASHER_NONHYPER_HARING_COUNTS_BY_STATE","SELECT HASHES.EVENT_STATE AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER = 0
GROUP BY HASHES.EVENT_STATE
ORDER BY THE_COUNT DESC");

define("HASHER_NONHYPER_HARING_COUNTS_BY_CITY","SELECT HASHES.EVENT_CITY AS THE_VALUE, COUNT(*) AS THE_COUNT
 FROM
	HARINGS
    JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
  WHERE
	HARINGS.HARINGS_HASHER_KY = ? AND
    HASHES.KENNEL_KY = ? AND
		HASHES.IS_HYPER =0
GROUP BY HASHES.EVENT_CITY
ORDER BY THE_COUNT DESC");

define("COHARE_COUNT_BY_HARE","SELECT
      	TEMPTABLE.HASHER_NAME AS THE_VALUE,
          COUNT(*) AS THE_COUNT
      FROM
      	HARINGS
          JOIN HASHERS ON HARINGS.HARINGS_HASHER_KY = HASHERS.HASHER_KY
          JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
          JOIN (
						SELECT
								HARINGS_HASH_KY,
								HASHER_NAME,
								HARINGS_HASHER_KY
						FROM
								HARINGS
						JOIN HASHERS ON HARINGS.HARINGS_HASHER_KY = HASHERS.HASHER_KY
		        JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
		        WHERE
								HASHES.KENNEL_KY = ?
					)
          TEMPTABLE ON HARINGS.HARINGS_HASH_KY = TEMPTABLE.HARINGS_HASH_KY
      WHERE
      	HARINGS.HARINGS_HASHER_KY = ?
          AND TEMPTABLE.HARINGS_HASHER_KY <> ?
          AND HASHES.IS_HYPER IN (?,?)
      GROUP BY TEMPTABLE.HASHER_NAME
      ORDER BY THE_COUNT DESC");

define("HARING_PERCENTAGE_ALL_HASHES","SELECT
	HASHERS.HASHER_NAME AS HASHER_NAME,
	hash_count_temp_table.HASH_COUNT AS HASH_COUNT,
	haring_count_temp_table.HARING_COUNT AS HARING_COUNT,
	((haring_count_temp_table.HARING_COUNT / hash_count_temp_table.HASH_COUNT) * 100) AS HARE_PERCENTAGE
FROM
	((HASHERS
	JOIN (
		SELECT
			HASHINGS.HASHER_KY AS HASHER_KY,
			COUNT(HASHINGS.HASHER_KY) AS HASH_COUNT
		FROM
			HASHINGS
            JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASHER_KY
        ) HASH_COUNT_TEMP_TABLE ON ((HASHERS.HASHER_KY = hash_count_temp_table.HASHER_KY)))
	JOIN (
		SELECT
			HARINGS.HARINGS_HASHER_KY AS HARINGS_HASHER_KY,
			COUNT(HARINGS.HARINGS_HASHER_KY) AS HARING_COUNT
		FROM
			HARINGS
            JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HARINGS.HARINGS_HASHER_KY
        ) HARING_COUNT_TEMP_TABLE ON ((HASHERS.HASHER_KY = haring_count_temp_table.HARINGS_HASHER_KY)))
WHERE
	(hash_count_temp_table.HASH_COUNT >= ?)
ORDER BY ((haring_count_temp_table.HARING_COUNT / hash_count_temp_table.HASH_COUNT) * 100) DESC");

define("HARING_PERCENTAGE_NON_HYPER_HASHES","SELECT
	HASHERS.HASHER_NAME AS HASHER_NAME,
	hash_count_temp_table.HASH_COUNT AS HASH_COUNT,
	haring_count_temp_table.HARING_COUNT AS HARING_COUNT,
	((haring_count_temp_table.HARING_COUNT / hash_count_temp_table.HASH_COUNT) * 100) AS HARE_PERCENTAGE
FROM
	((HASHERS
	JOIN (
		SELECT
			HASHINGS.HASHER_KY AS HASHER_KY,
			COUNT(HASHINGS.HASHER_KY) AS HASH_COUNT
		FROM
			HASHINGS
            JOIN HASHES ON HASHINGS.HASH_KY = HASHES.HASH_KY
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASHER_KY
        ) HASH_COUNT_TEMP_TABLE ON ((HASHERS.HASHER_KY = hash_count_temp_table.HASHER_KY)))
	JOIN (
		SELECT
			HARINGS.HARINGS_HASHER_KY AS HARINGS_HASHER_KY,
			COUNT(HARINGS.HARINGS_HASHER_KY) AS HARING_COUNT
		FROM
			HARINGS
            JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
		WHERE
			HASHES.KENNEL_KY = ?
			AND HASHES.IS_HYPER=0
		GROUP BY HARINGS.HARINGS_HASHER_KY
        ) HARING_COUNT_TEMP_TABLE ON ((HASHERS.HASHER_KY = haring_count_temp_table.HARINGS_HASHER_KY)))
WHERE
	(hash_count_temp_table.HASH_COUNT >= ?)
ORDER BY ((haring_count_temp_table.HARING_COUNT / hash_count_temp_table.HASH_COUNT) * 100) DESC");

DEFINE("LOWEST_HASH_ATTENDANCE_BY_HARE","SELECT
	HASHERS.HASHER_NAME AS NAME,
	MIN(temptable.THE_COUNT) AS VALUE
FROM
	(((HASHERS
	JOIN HARINGS ON ((HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY)))
	JOIN HASHES ON ((HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY)))
	JOIN
    (
		SELECT HASHINGS.HASH_KY AS THE_HASH_KEY,COUNT(0) AS THE_COUNT
		FROM
			HASHES
			JOIN HASHINGS ON ((HASHES.HASH_KY = HASHINGS.HASH_KY))
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASH_KY
	) TEMPTABLE ON ((HASHES.HASH_KY = temptable.THE_HASH_KEY)))
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE");

DEFINE("HIGHEST_HASH_ATTENDANCE_BY_HARE","SELECT
	HASHERS.HASHER_NAME AS NAME,
	MAX(temptable.THE_COUNT) AS VALUE
FROM
	(((HASHERS
	JOIN HARINGS ON ((HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY)))
	JOIN HASHES ON ((HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY)))
	JOIN
    (
		SELECT HASHINGS.HASH_KY AS THE_HASH_KEY,COUNT(0) AS THE_COUNT
		FROM
			HASHES
			JOIN HASHINGS ON ((HASHES.HASH_KY = HASHINGS.HASH_KY))
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASH_KY
	) TEMPTABLE ON ((HASHES.HASH_KY = temptable.THE_HASH_KEY)))
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC");

DEFINE("AVERAGE_HASH_ATTENDANCE_BY_HARE","SELECT
	HASHERS.HASHER_NAME AS NAME,
	AVG(temptable.THE_COUNT) AS VALUE
FROM
	(((HASHERS
	JOIN HARINGS ON ((HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY)))
	JOIN HASHES ON ((HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY)))
	JOIN
    (
		SELECT HASHINGS.HASH_KY AS THE_HASH_KEY,COUNT(0) AS THE_COUNT
		FROM
			HASHES
			JOIN HASHINGS ON ((HASHES.HASH_KY = HASHINGS.HASH_KY))
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASH_KY
	) TEMPTABLE ON ((HASHES.HASH_KY = temptable.THE_HASH_KEY)))
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC");

DEFINE("GRANDTOTAL_NONDISTINCT_HASH_ATTENDANCE_BY_HARE","SELECT
	HASHERS.HASHER_NAME AS NAME,
	SUM(temptable.THE_COUNT) AS VALUE
FROM
	(((HASHERS
	JOIN HARINGS ON ((HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY)))
	JOIN HASHES ON ((HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY)))
	JOIN
    (
		SELECT
			HASHINGS.HASH_KY AS THE_HASH_KEY,
			COUNT(0) AS THE_COUNT
		FROM
			HASHES
			JOIN HASHINGS ON HASHES.HASH_KY = HASHINGS.HASH_KY
		WHERE
			HASHES.KENNEL_KY = ?
		GROUP BY HASHINGS.HASH_KY
	) TEMPTABLE ON HASHES.HASH_KY = temptable.THE_HASH_KEY)
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC");

DEFINE ("GRANDTOTAL_DISTINCT_HASH_ATTENDANCE_BY_HARE","SELECT
	HASHERS.HASHER_NAME AS NAME,
	COUNT(DISTINCT HASHINGS.HASHER_KY) AS VALUE
FROM
	HASHERS
	JOIN HARINGS ON HASHERS.HASHER_KY = HARINGS.HARINGS_HASHER_KY
	JOIN HASHES ON HARINGS.HARINGS_HASH_KY = HASHES.HASH_KY
	JOIN HASHINGS ON HASHES.HASH_KY = HASHINGS.HASH_KY
WHERE HASHES.KENNEL_KY = ?
GROUP BY HASHERS.HASHER_NAME
ORDER BY VALUE DESC");
